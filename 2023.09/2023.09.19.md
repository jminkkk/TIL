# 스트림은 주의해서 사용하라

### 스트림 API 등장

자바 8에서 다량의 데이터 처리 작업을 돕고자 추가

### 스트림이 제공하는 추상 개념

1. 스트림은 데이터 원소의 유한 혹은 무한 시퀸스를 뜻한다.
2. 스트림 파이프라인은 이 원소들로 수행하는 연산 단계를 표현하는 개념이다.

### 스트림의 특징

- 스트림의 원소들은 컬렉션, 배열, 파일, 매처, 난수 생성기 등 어디로부터든 올 수 있음
- 스트림 안의 데이터 원소들은 객체 참조나 기본 타입 값이다.
- 스트림 파이프라인은 소스 스트림에서 시작해 종단 연산으로 끝나며, 그 사이에 하나 이상의 중간 연산이 있을 수 있다.
    - 각 중간 연산은 스트림을 어떠한 방식으로 변환한다.

### 스트림의 지연 평가

평가는 종단 연산이 호출될 때 이뤄지며, 종산 연산에 쓰이지 않는 데이터 원소는 계산에 쓰이지 않음

- 이러한 **지연평가가** 무한 스트림을 다룰 수 있게 해주는 열쇠

종단연산이 없는 스트림 파이프라인은 아무일도 하지 않는 명령어 → 절대 종단 연산을 빼먹으면 안됨

### 스트림은 플루언트

파이프라인 하나를 구성하는 모든 호출을 연결하여 단 하나의 표현식으로 완성할 수 있음

기본적으로 스트림 파이프라인은 순차적으로 수행된다.

- 파이프라인을 병렬로 실행하려면 파이프라인을 구성하는 parallel 메서드를 호출하면 되지만 그닥

### 적절하게 사용하라

스트림을 과용하면 프로그램이 읽거나 유지보수하기 어려워진다.

때문에 스트림과 반복문을 적절히 조합하는 게 최선이다.

**기존 코드는 스트림을 사용하도록 리팩터링하되, 새 코드가 더 나아보일 때만 반영하자.**

## 함수 객체 vs 코드블럭

### 코드블럭을 사용할 경우

스트림 파이프라인은 되풀이되는 계산을 **함수 객체(주로 람다나 메서드 참조)로 표현**

반면, 반복 코드에서는 코드 블록을 사용해 표현한다.

**하지만 함수 객체로는 할 수 없지만 코드 블록으로 할 수 있는 일들이 있으니 그 예이다.**

1. 코드 블록에서는 범위 안의 지역변수를 읽고 수정이 가능
    - 하지만 람다에서는 final이거나 사실상 final인 변수만 읽을 수 있고 지역변수를 수정하는 건 불가능
2. 코드 블록에서는 return문을 사용해 메서드를 빠져나가거나, break나 continue문으로 블록 바깥의 반복문을 종료, 건너뀔 수 있음
3. 또한, 메서드 선언에 명시된 검사 예외를 던질 수 있음
    - 하지만 람다는 모두 불가능

### 람다를 사용할 경우

반대로 다음의 일들에는 스트림이 안성맞춤이다.

- 원소들의 시퀸스를 일관되게 변환
- 원소들의 시퀸스를 필터링
- 원소들의 시퀸스를 하나의 연산을 사용해 결합
- 원소들의 시퀸스를 컬렉션에 모음
- 원소들의 시퀸스에서 특정 조건을 만족하는 원소를 찾음