# ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬ì™€ MVC íŒ¨í„´
> íŒ¨ìŠ¤íŠ¸ìº í¼ìŠ¤ì˜ ë‚¨ê¶ì„±ë‹˜ ìŠ¤í”„ë§ ê°•ì˜ë¥¼ ë³´ê³  ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.
### ê´€ì‹¬ì‚¬ë€?

ë§ ê·¸ëŒ€ë¡œ ìš°ë¦¬ê°€ ê´€ì‹¬ì„ ê°€ì§€ê³  ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ì‘ì—…ë“¤

- SRP ì›ì¹™ì— ì˜í•´ í•˜ë‚˜ì˜ ë©”ì„œë“œëŠ” í•˜ë‚˜ì˜ **ì±…ì„(= ê´€ì‹¬ì‚¬)**ë§Œ ê°€ì§€ê³  ìˆì–´ì•¼ í•˜ë¯€ë¡œ ê¸°ì¡´ì˜ ì‹¤ìŠµ ì½”ë“œì—ì„œ 3ê°œì˜ ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•´ì•¼ í•¨

### ì–´ë–¤ ê²ƒì„ ë¶„ë¦¬í•´ì•¼ í• ê¹Œ?

- ê´€ì‹¬ì‚¬
- ë³€í•˜ëŠ” ê²ƒê³¼ ë³€í•˜ì§€ ì•ŠëŠ” ê²ƒ
- ê³µí†µ ì½”ë“œ
    - ì¤‘ë³µë˜ëŠ” ì½”ë“œ

## ìŠ¤í”„ë§ì˜ êµ¬ì¡°


- ì‚¬ìš©ìì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ìŠ¤í”„ë§ì€ ìœ„ì™€ ê°™ì€ êµ¬ì¡°ë¥¼ í†µí•´ ì²˜ë¦¬í•¨

<aside>
ğŸ’¡ Springì—ì„œ ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ê²½ìš° (ë‹¨ìˆœí™”)

1. DispatcherServletì´ ì…ë ¥ì„ ì²˜ë¦¬
2. DispatcherServletëŠ” ì²˜ë¦¬í•œ ì…ë ¥ì™€ Modelì„ Controllerì— ì „ë‹¬
3. Controllerê°€ ì²˜ë¦¬í•œ ê²°ê³¼ë¥¼ Modelì— ì €ì¥í•˜ì—¬ ë‹¤ì‹œ DispatcherServletì—ê²Œ ì „ë‹¬
4.  DispatcherServletëŠ” Modelì„ ë¶„ë¦¬í•˜ì—¬ Viewì—ê²Œ í•´ë‹¹ Modelì„ ì „ë‹¬
5. Viewì—ì„œëŠ” ê·¸ Modelì„ í†µí•´ ì‘ë‹µì„ ë§Œë“¤ì–´
6. ì»¨íŠ¸ë¡¤ëŸ¬ì—ê²Œ ì „ë‹¬
</aside>

---

```java
@Controller
public class YoilTellerMVC {
    @RequestMapping("/getYoilMVC") // http://localhost/ch2/getYoilMVC
    public String main(int year, int month, int day, Model model) {
 
        // 1. ìœ íš¨ì„± ê²€ì‚¬
    	if(!isValid(year, month, day)) 
    		return "yoilError";  // ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´, /WEB-INF/views/yoilError.jspë¡œ ì´ë™
    	
        // 2. ì²˜ë¦¬
    	char yoil = getYoil(year, month, day);

        // 3. Modelì— ì‘ì—… ê²°ê³¼ ì €ì¥
        model.addAttribute("year", year);
        model.addAttribute("month", month);
        model.addAttribute("day", day);
        model.addAttribute("yoil", yoil);
        
        // 4. ì‘ì—… ê²°ê³¼ë¥¼ ë³´ì—¬ì¤„ Viewì˜ ì´ë¦„ì„ ë°˜í™˜
        return "yoil"; // /WEB-INF/views/yoil.jsp
    }
```

- `return "yoil";`ì´ë‚˜  `return "yoilError";` ì—ì„œì˜ ê²½ë¡œê°€ ***/WEB-INF/views*ì— ì €ì¥ë˜ëŠ” ê²ƒì„ ìœ ì˜í•˜ì!!!**
    - servlet-context.xmlì—ì„œ í”„ë¡œí¼í‹°ë¡œ ê²½ë¡œ ìˆ˜ì • ê°€ëŠ¥

```java
<%@ page contentType="text/html;charset=utf-8" %> // ì¸ì½”ë”© ì •ë³´
```

### ModelAndView

- Controller ë©”ì„œë“œì— Modelì„ íŒŒë¼ë¯¸í„°ë¡œ ì…ë ¥í•˜ì§€ ì•Šìœ¼ë©´ DispatcherServletì—ì„œ ìƒì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ë©”ì„œë“œ ë‚´ì—ì„œ ModelAndView ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ì•¼ í•¨
- ModelAndViewë¥¼ ë¦¬í„´í•˜ë©´ DispatcherServletì—ì„œ Modelì„ êº¼ë‚¸ í›„ viewì—ê²Œ ì „ë‹¬

### 

```java
public class MethodInfo {
	public static void main(String[] args) throws Exception{

		Class clazz = Class.forName("com.fastcampus.ch2.YoilTeller");
		Object obj = clazz.newInstance();
		
		Method[] methodArr = clazz.getDeclaredMethods();
		
		for(Method m : methodArr) {
			String name = m.getName();
			Parameter[] paramArr = m.getParameters();
//			Class[] paramTypeArr = m.getParameterTypes();
			Class returnType = m.getReturnType();
			
			StringJoiner paramList = new StringJoiner(", ", "(", ")");
			
			for(Parameter param : paramArr) {
				String paramName = param.getName();
				Class  paramType = param.getType();
				
				paramList.add(paramType.getName() + " " + paramName);
			}
			
			System.out.printf("%s %s%s%n", returnType.getName(), name, paramList);
		}
	} // main
}
```

`Method[] methodArr = clazz.getDeclaredMethods();` 

- í•´ë‹¹ í´ë˜ìŠ¤ì˜ ëª¨ë“  ë©”ì„œë“œë“¤ì„ ì¶”ì¶œí•˜ëŠ” ë©”ì„œë“œì™€ ì´ë¥¼ ë°°ì—´ë¡œ ì €ì¥

### ë§¤ê°œë³€ìˆ˜ ì´ë¦„ì„ ì–»ì–´ì˜¤ê¸°

ìë°”ì—ì„œëŠ” 2ê°€ì§€ ë°©ë²•

- Reflection API
- Class íŒŒì¼

```java
public class MethodCall2 {
	public static void main(String[] args) throws Exception{

		Class clazz = Class.forName("com.fastcampus.ch2.YoilTellerMVC");
		Object obj = clazz.newInstance();
		
		Method main = clazz.getDeclaredMethod("main", int.class, int.class, int.class, Model.class);
		
		Model model = new BindingAwareModelMap();
		System.out.println("[before] model="+model);
		
		**// String viewName = obj.main(2021, 10, 1, model);
		String viewName = (String)main.invoke(obj, new Object[] { 2021, 10, 1, model }); 	
		// Reflection API ì´ìš©í•œ í˜¸ì¶œ**
		
		System.out.println("viewName="+viewName);	
		
		// Modelì˜ ë‚´ìš©ì„ ì¶œë ¥ 
		System.out.println("[after] model="+model);
				
		// í…ìŠ¤íŠ¸ íŒŒì¼ì„ ì´ìš©í•œ rendering
		render(model, viewName);			
	} // main
```

### @WebServletì´ë€

- @Controller + @RequestMappingì„ í•©ì¹œ ì–´ë…¸í…Œì´ì…˜
- í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì˜ í´ë˜ìŠ¤ëŠ” HttpServletì„ ìƒì†ë°›ì•„ì•¼ í•˜ë©° serviceë¼ëŠ” ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©