## 세마포어란?
> [What is Semaphore?](https://www.guru99.com/semaphore-in-operating-system.html)를 보고 작성하였습니다.
>
세마포어는 단순히 음수가 아닌 변수이며 스레드 간에 공유되는 변수로, **shared data의 개수를 의미**

- 세마포어는 **시그널링 메커니즘**이며,
- **세마포어에서 대기 중인 스레드는 다른 스레드에 의해 시그널링 가능**
- 세마포어는 프로세스 동기화를 위해 1) Wait 2) Signal라는 두 가지 원자 연산을 사용

세마포어는 리소스에 대한 액세스를 허용하거나 허용하지 않으며, 이는 설정 방법에 따라 달라짐

### 세마포어의 특징

- **작업의 동기화를 제공**하는 데 사용할 수 있는 메커니즘
- 저수준 동기화 메커니즘
- 세마포어는 항상 음수가 아닌 정수 값을 보유
- 세마포어는 테스트 연산과 인터럽트를 사용하여 구현할 수 있으며, 파일 기술자를 사용하여 실행해야 함

## 세마포어의 유형

세마포어의 일반적인 두 가지 유형은 다음과 같음

### Counting semaphores

- 카운팅 세마포어는 작업을 여러 번 획득하거나 해제하는 데 도움이 되는 카운트를 사용
- 초기 카운트가 0이면 카운팅 세마포어는 **사용할 수 없는 상태로 생성**되어야 함
- 카운트가 0보다 크면 세마포어는 사용 가능한 상태로 생성되며,
    - 보유한 토큰의 개수는 카운트와 같음
    
    ![image](https://github.com/jminkkk/TIL/assets/102847513/3b35df6e-4d48-45cc-8f87-74697aa0ea45)
    

### Binary semaphores

- 바이너리 세마포어는 카운팅 세마포어와 매우 유사하지만 그 값이 0과 1로 제한
- 이 유형의 세마포어에서 대기 연산은 세마포어 = 1일 때만 작동하고 신호 연산은 세마포어 = 0일 때 성공/
    
    ![image](https://github.com/jminkkk/TIL/assets/102847513/6503d02c-21aa-4577-a0d6-581a69aba42f)


# 예제

```java
Shared var mutex: semaphore = 1;
Process i
    begin
    .
    .
    P(mutex);
    execute CS;
    V(mutex);
    .
    .
    End;
```

## 세마포어의 대기 및 신호 연산

- 이 두 연산은 모두 프로세스 동기화를 구현하는 데 사용
- 세마포어 **연산의 목표는 상호 배제**를 얻는 것

### 대기 연산

- 이 유형의 세마포어 연산을 사용하면 **작업의 중요 섹션 진입을 제어 가능**
- 그러나 wait의 값이 양수이면 wait 인자 X의 값이 감소
    - 음수이거나 0인 경우에는 연산이 실행되지 않음
    - 이를 **P(S) 연산**이라고도 함
- 세마포어 값이 감소하여 음수가 되면 필요한 조건이 만족될 때까지 명령이 보류

```java
Copy CodeP(S)
{
    while (S<=0);
    S--;
}
```

### 신호 연산

- 신호 세마포어 연산은 중요한 섹션에서 **작업의 종료를 제어**하는 데 사용
- 인수의 값을 1씩 증가시키며, 이를 **V(S)**로 표시

```java
Copy CodeP(S)
{
    while (S>=0);
    S++;
}
```