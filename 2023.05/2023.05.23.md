# Servlet Filter

## 필터란?
> [참고](https://twofootdog.github.io/Spring-%ED%95%84%ED%84%B0(Filter)%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80/)

필터는 **리소스(서블릿 또는 정적 콘텐츠)에 대한 요청**이나 **리소스로부터의 응답** 또는 둘 다에 대해 **필터링 작업**을 수행하는 객체

→ 객체의 형태로 존재하며 **클라이언트로부터 오는 요청과 최종 자원**(JPS, 서블릿, 기타 자원) 사이에 위치하며 **클라이언트의 요청 정보를 변경 가능**

![image](https://github.com/jminkkk/TIL/assets/102847513/f51242a2-49d2-47cf-830a-4b9cca0c8408)


### 필터 체인?

필터는 클라이언트와 자원사이에 1개가 존재하는 경우가 보통이지만, 여러개의 필터가 모여서 하나의 체인(chain)을 형성

- 필터 체인에서 첫번째 필터가 변경하는 요청정보는 클라이언트의 요청정보가 되지만,
- 체인의 두번째 필터가 변경하는 요청정보는 첫번째 필터를 통해서 변경된 요청정보가 됨
- 즉 **요청정보는 변경에 변경에 변경을 거듭**
    - 응답정보의 경우도 요청정보와 비슷한 과정을 거치지만 차이점은 필터의 적용순서가 요청때와는 반대
- 필터는 요청/응답 정보를 변경하는 역할 뿐 아니라 **흐름을 변경하는 역할** 가능
- **즉 필터는 클라이언트의 요청을 필터체인의 다음단계에 보내는 것이 아니라, 다른 자원의 결과를 클라이언트에 전송 가능**

## Filter의 메서드

### init()

```java
void init(FilterConfig filterConfig) throws ServletException
```

웹 컨테이너에서 호출하여 필터가 서비스 중임을 필터에 알림

- 서블릿 컨테이너는 필터를 **인스턴스화한** 후 **정확히 한 번만 init 메서드**를 호출
- 필터가 필터링 작업을 수행하도록 요청받기 전에 초기화 메서드가 성공적으로 완료되어야 함
- 초기화 메서드에서 다음과 같은 오류가 발생하면 웹 컨테이너는 **필터를 서비스에 배치할 수 없음**
    1. Throws a ServletException
    2. 웹 컨테이너에서 정의한 기간 내에 반환되지 않을 경우

### doFilter

```java
void doFilter(ServletRequest request,
              ServletResponse response,
              FilterChain chain)
              throws java.io.IOException, ServletException
```

doFilter 메서드는 필터 기능을 작성하는 메서드로,

- JSP 컨테이너가 필터를 리소스에 적용할 때마다 호출되는 메서드
- 필터가 어떤 기능을 수행할 필요가 있을 때마다 호출
- 이 메서드에 전달된 FilterChain은 필터가 요청과 응답을 체인의 다음 엔티티로 전달할 수 있도록 함

### destory

```java
void destroy()
```

**필터가 서비스 중단 중**임을 필터에 알리기 위해 웹 컨테이너에 의해 호출

- 필터 인스턴스를 종료하기 전에 호출하는 메서드
- 필터의 수명 동안 한 번만 호출