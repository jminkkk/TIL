# 메모리 계층
> 소스 스터디 및 [CS 면접 스터디 깃헙](https://github.com/devSquad-study/2023-CS-Study) 참고
# 메모리

## 레지스터

CPU가 요청을 처리하는 데 필요한 데이터를 **일시적으로 저장하는** 기억장치

- CPU(Central Processing Unit), 중앙처리 장치
    - 프로세스가 실행되려면 프로그램이 메모리에 올라와야함
    - CPU는 자체적으로 데이터를 저장할 방법이 없으므로 메모리로 직접 데이터를 전송할 수 없음
        - 연산을 위해서 **반드시 레지스터를 거쳐야** 하며, 이를 위해 레지스터는 특정 주소를 가리키거나 값을 읽어올 수 있음

## 캐시

- 개념
    - 데이터나 값을 **미리 복사해** 놓는 **임시 장소**
    - 시스템의 **효율성을** 위해 사용
        - 캐시의 접근 시간에 비해 원래 데이터를 접근하는 시간이 오래 걸리는 경우
        - 값을 다시 계산하는 시간을 절약하고 싶은 경우
    - 속도가 빠른 장치와 느린 장치 사이에서 **속도차에 따른 병목 현상을** 완화하기 위한 범용 메모리
- 캐싱(Caching) : 캐시(Cache)라고 하는 좀 더 빠른 메모리 영역으로 데이터를 가져와서 접근하는 방식

### 캐시의 종류

**CPU 캐시**

- 대용량의 메인 메모리 접근을 빠르게 하기 위해 CPU 칩 내부나 바로 옆에 탑재하는 작은 메모리
- 하드웨어를 통해 관리


| 종류 | 설명 | CPU 성능에 직접적인 영향 |
| --- | --- | --- |
| L1 캐시 | 일반적으로 CPU 칩안에 내장되어 데이터 사용 및 참조에 가장 먼저 사용되는 캐시 메모리 | O |
| L2 캐시 | L1 캐시 메모리와 용도와 역할이 비슷

속도 : L1 캐시 > L2 캐시 > 일반메모리(RAM) | O |
| L3 캐시 | L1 캐시, L2 캐시와 동일한 원리로 작동

대부분 CPU가 아닌 메인보드에 내장 | X |

## 메인 메모리(주기억장치)

**주기억장치**(=1차 기억 장치)는 실행될 프로그램과 데이터를 기억

- 기억된 명령은 **한 번에 하나씩 제어장치에** 의해 가져와서 해독된 후 **신호로 바뀌어** 각 **장치로 전달**되며,
- 주기억장치와 중앙처리장치 사이에서 데이터의 이동을 위해 연결된 선들을 버스라고 함

### 주기억장치

- **RAM(Random Access Memory)** : 휘발성 기억 장치
    - 전원이 꺼지면 기억된 내용이 모두 사라지는 메모리
    - 전원이 유지되는 동안 CPU의 연산 및 동작에 필요한 모든 내용이 저장
    - `Random Access` : 어느 위치에서든 똑같은 속도로 접근하여 읽고 쓸 수 있다는 의미

<aside>
💡 RAM을 주기억장치라고 표현하는 이유는?

실제 사용 중일 때 즉, 우리가 어떠한 프로그램을 컴퓨터에서 실행해서 그 컴퓨터가 동작을 하는 과정에서는 **RAM과 CPU에서의 동작으로** 이루어진다

1. 보조기억장치에서 주기억장치로 프로그램을 불러온다. (부팅 또는 로딩)

2. 주기억장치에서 프로그램을 기억하고 CPU와 통신할 준비를 한다. (동작 및 구동)

3. 주기억장치와 CPU에서 데이터를 주고받으며 프로그램을 구동한다. (동작 및 구동)

</aside>

<aside>
💡 왜 불편하게 전원이 차단되면 모든 기억된 내용이 지워지는 휘발성 장치를 사용할까요?

대표적인 RAM의 기계적인 특성 때문이다. 

**휘발성이라는 기계적 단점을** 가진 부품을 주기억장치로 사용하는 이유는 단점에도 불구하고 **빠른 속도**와 **효율을 제공**해 주기 때문이다.

</aside>

- **ROM(Read Only Memory)** : 고정 기억 장치
    - 컴퓨터에 지시사항을 영구히 저장하는 비휘발성 메모리
    - 전원이 실제로 꺼져도 기억된 내용이 지워지지않는 메모리
        - 변경 가능성이 희박한 기능 및 부품에 사용

<aside>
💡 캐시 메모리와 주기억장치의 차이점에 대해 설명해 주세요.

</aside>

## **보조기억장치**

보조기억장치는 **중앙처리장치에서 요청이 오면 저장하고 있던 프로그램과 데이터를 주기억장치로 전송한다**. 

대표적인 보조기억장치로 하드디스크,SSD,USB메모리, 광디스크가 있다.

- 개념
    - 하드 디스크(Hard Disk), 하드 드라이브(Hard Drive), 고정 디스크(Fixed Drive)
    - 비휘발성, 순차접근이 가능한 컴퓨터의 보조 기억 장치
    - 비휘발성 데이터 저장소 가운데 가장 대중적이며 용량 대비 가격이 가장 저렴
- 작동 원리
    - 보호 케이스 내부의 플래터를 회전 → 플래터에 자기 패턴으로 정보 기록
    - 플래터 표면의 코팅된 자성체에 데이터 기록
    - 회전하는 플래터 위에 부상하는 입출력 헤드에 의해 자기적으로 데이터 기록 및 조회 가능

## 계층 구조 필요성

<aside>
💡 만약 필요한 데이터가 하드디스크에 있다면, CPU에서 바로 하드디스크에 접근해서 데이터를 가져오면 더 빠를텐데 왜 굳이 모든 계층구조를 모두 통해서 가져올까요?

</aside>

### 1. **디코딩(명령어 해독 단계) 속도**

- 큰 메모리 용량을 사용할 경우 디코딩하는 데 더 많은 시간 소요
    - **CPU가 빠르게 데이터에 접근하기 위해서는 데이터를 저장하는 메모리가 작아야 함**
- CPU는 3개의 버스를 통해 메모리에 접근함
    - 주소 전달 버스 : CPU가 메모리의 어느 부분의 데이터를 접근할지 나타냄
    - 데이터 전달 버스 : 메모리와 CPU 간 데이터 전송
    - 컨트롤 신호 버스 : CPU의 메모리 접근 여부 표시
- 주소 전달 버스 및 데이터 전달 버스에 값이 존재하고 컨트롤 신호를 전송 → CPU와 메모리 업무 수행
- 큰 메모리 용량을 사용할 경우 디코딩하는 데 더 많은 시간 소요됨→ **CPU가 빠르게 데이터에 접근하기 위해서는 데이터를 저장하는 메모리가 작아야 함**

### 2. 자주 쓰는 데이터는 계속 자주 쓰임(참조의 지역성)

- 큰 메모리를 사용한다고 해도 그 안의 모든 데이터를 고르게 접근하지 않음
- **자주 쓰이는 데이터는 계속 자주 쓰이고, 자주 쓰이지 않는 데이터는 계속 자주 쓰이지 않음**=> 운영체제·CPU → 자동으로 자주 쓰이거나 쓰일 것 같은 데이터를 메모리에서 캐시로 읽어옴
- 자주 쓰이는 데이터는 전체 데이터 양에 비해 작은 양이므로 캐시는 메모리보다, 메모리는 하드디스크보다 더 작아도 됨

### 3. 경제성

- 메모리 구조에서 상층에 속할수록 더 비쌈
- 메모리 계층 구조의 모양이 피라미드인 이유
    - 비싼 하드웨어는 꼭 필요한 만큼의 크기만 사용
    - 싼 하드웨어를 넉넉한 크기만큼 사용
