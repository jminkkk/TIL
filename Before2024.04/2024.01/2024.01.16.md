# 병렬 데이터 처리와 성능
## 병렬 스트림

각각의 스레드에서 처리할 수 있도록 스트림 요소를 여러 청크로 분할한 스트림
### 순차 스트림을 병렬 스트림으로 변환
순차 스트림에 parallel 메서드를 호출하면 기존의 함수형 리듀싱 연산(숫자 합계 계산)이 병렬로 처리된다.

```java
public long parallelSum(long n){
	return Stream.iterate(1L, i-> i+1) 
    			.limit(n) 
                .parallel() // 스트림을 병렬 스트림으로 변환
                .reduce(0L, Long:sum);
```

순차 스트림에 parallel을 호출해도 스트림 자체에는 아무 변화 X
+ 내부적으로는 parallel을 호출하면 이후 연산이 병렬로 수행해야 함을 의미하는 불리언 플래그가 설정
+ 반대로 sequential로 병렬 스트림을 순차 스트림으로 변경 가능

## 스트림 성능 측정
병럴화를 이용하면 순차나 반복 형식에 비해 성능이 더 좋아질 것이라 예상

+ 병렬처리를 오용하면 오히려 전체 프로그램의 성능이 더 나빠질 수도 있다.
    + 병렬 스트림을 활용하려면 그에 맞는 스트림 모델이 필요
+ 자동 박싱과 언박싱은 성능을 크게 저하시킬 수 있는 요소이므로 주의해서 사용
    + 기본형 특화 스트림(IntStream, LongStream, DoubleStream)을 사용하는 것이 좋음
+ 스트림에서 수행하는 전체 파이프라인 연산 비용을 고려
+ 병렬화 과정의 부가 비용을 상쇄하지 못할 정도의 소량의 데이터에서는 병렬스트림이 도움되지 않는다.
