# 프록시란
> 프록시 라는 개념에 대해 가짜 객체다. 라는 정도만 이해하고 있어서 더 정확하게 그리고 왜 이 개념이 태어났는지 파악하고자 작성한다.

> 김영한님의 JPA 책을 보고 정리함

JPA의 실제 엔티티를 필요할 때 사용할 수 있도록 하는 **가짜 객체**
+ 실제 엔티티를 상속받아 겉모습은 같지만 안에가 비어있다
  + 안이 비어있다는 것이 와닺지 않았는데 값이 비어있다는 의미
  + JPA의 구현체인 하이버네이트가 프록시 라이브러리를 사용하여 상속한다.
+ 프록시 객체는 실제 객체의 참조(target)을 보관한다.
+ 프록시 객체를 호출하면 프록시 객체는 **실제 객체의 메소드를 호출한다.**

## JPA의 특징과 프록시 사용 이유
JPA는 기본적으로 연관관계를 갖는 모든 엔티티를 조인함
+ 따라서 불필요한 엔티티의 정보까지 가지고 올 수 있기 때문에 비효율적인 상황이 발생할 수도 있다.

따라서 JPA는 프록시를 통해 이런 상황을 해결한다.

## 프록시 객체의 초기화
실제 사용될 때 데이터베이스를 조회해서 실제 엔티티 객체를 생성하는 것을 말한다.
+ 프록시 객체에 member.getName()을 호출해서 실제 데이터를 조회
+ 프록시 객체는 실제 엔티티가 생성되어 있지 않으면 영속성 컨텍스트 실제 엔티티 생성을 요청
+ 영속성 컨텍스트는 데이터베이스를 조회해서 실제 엔티티 객체를 생성
+ 프록시 객체는 생성된 실제 엔티티 객체의 참조를 Member target 멤버변수에 보관
+ 프록시 객체는 실제 엔티티 객체의 getName()을 호출해서 결과를 반환

## 프록시의 특징
1. 프록시 객체는 처음 사용할때 한번만 초기화

2. 프록시 객체가 실제 엔티티로 교체되는 것이 아니라 
  + 초기화가 되면 프록시는 유지
  + 내부의 target이 채워지면서 프록시 객체를 통해서 실제 엔티티에 접근 가능

3. 프록시 객체는 원본 엔티티를 상속받기 때문에 타입체크시 주의
  + member1.getClass()==member2.getClass() 비교는 실패하기 때문에 instance of를 사용해야 함


